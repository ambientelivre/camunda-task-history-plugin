<ng-container *ngIf="history$ | async as h; else loading">
  <ng-template #header>
    <tr>
      <th>#</th>
      <th>{{ "labels.ACTION" | translate }}</th>
      <th>{{ "labels.VARIABLE_NAME" | translate }}</th>
      <th>{{ "labels.VARIABLE_VALUE" | translate }}</th>
      <th>{{ "labels.CREATION_DATE" | translate }}</th>
      <th>{{ "labels.FINISHED" | translate }}</th>
    </tr>
  </ng-template>

  <ng-template #body>
    <tr *ngFor="let h of h; let i = index">
      <td>
        <b>{{ i }}</b>
      </td>
      <td>{{ h.type }}</td>
      <td>{{ h.key }}</td>
      <td [ngSwitch]="h.valueType">
        <ng-container *ngSwitchCase="'null'"></ng-container>

        <div *ngSwitchCase="'String'">
          <input class="form-control" type="text" readonly [value]="h.value" />
        </div>

        <div *ngSwitchCase="'Boolean'">
          <input
            class="form-control"
            type="checkbox"
            disabled
            [checked]="h.value"
          />
        </div>

        <ng-template *ngSwitchCase="'Short'" [ngTemplateOutlet]="inputNumber">
        </ng-template>

        <ng-template
          *ngSwitchCase="'Integer'"
          [ngTemplateOutlet]="inputNumber"
        ></ng-template>

        <ng-template *ngSwitchCase="'Long'" [ngTemplateOutlet]="inputNumber">
        </ng-template>

        <ng-template
          *ngSwitchCase="'Double'"
          [ngTemplateOutlet]="inputNumber"
        ></ng-template>

        <ng-template #inputNumber>
          <div class="form-group">
            <input
              class="form-control"
              type="number"
              readonly
              [value]="h.value"
            />
          </div>
        </ng-template>

        <a
          *ngSwitchCase="'File'"
          href="/camunda/api/engine/engine/default/variable-instance/{{
            h.id
          }}/data"
          ><button type="button" class="btn btn-primary">
            {{ "labels.DOWNLOAD" | translate }}
          </button></a
        >

        <ngx-json-viewer
          *ngSwitchCase="'Json'"
          [json]="parse(h.value)"
        ></ngx-json-viewer>

        <ng-container *ngSwitchDefault>
          <ngx-json-viewer [json]="h.value"></ngx-json-viewer>
        </ng-container>
      </td>
      <td>{{ h.startTime | date : "M/d/yy, h:mm:ss" }}</td>
      <td>{{ h.endTime | date : "M/d/yy, h:mm:ss" }}</td>
    </tr>
  </ng-template>

  <custom-table [thead]="header" [tbody]="body"></custom-table>
</ng-container>

<ng-template #loading>
  <custom-loading></custom-loading>
</ng-template>
