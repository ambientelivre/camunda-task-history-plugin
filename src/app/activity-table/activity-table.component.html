<div class="row">
  <div class="col-md-6" *ngIf="taskProcessInstance$ | async as t">
    <table class="table table-hover table-bordered cam-table">
      <tr>
        <th>Tarefa</th>
        <th>Assignee</th>
        <th>Inicio</th>
        <th>Fim</th>
        <th>Duração</th>
      </tr>

      <ng-container *ngFor="let t of t">
        <tr *ngIf="t.detail.length > 0">
          <td>{{ t.name }}</td>
          <td>{{ t.assignee }}</td>
          <td>{{ t.startTime | date : "M/d/yy, h:mm:ss" }}</td>
          <td>{{ t.endTime | date : "M/d/yy, h:mm:ss" }}</td>
          <td>{{ t.duration | durationFormat : "ms" : "hhmmss" }}</td>
        </tr>

        <tr *ngFor="let d of t.detail">
          <table class="table table-hover table-bordered cam-table">
            <tr>
              <th>Ação</th>
              <th>Variavel</th>
              <th>Valor</th>
              <th>Criação</th>
              <th>Remoção</th>
            </tr>

            <tr>
              <td>{{ d.type }}</td>
              <td>{{ d.variableName || d.fieldId }}</td>
              <td>{{ d.value || d.fieldValue }}</td>
              <td>{{ d.time | date : "M/d/yy, h:mm:ss" }}</td>
              <td>{{ d.removalTime }}</td>
            </tr>
          </table>
        </tr>
      </ng-container>
    </table>
  </div>

  <div class="col-md-6" *ngIf="variableCreation$ | async as v">
    <table
      class="table table-hover table-bordered cam-table"
      *ngIf="v.length > 0"
    >
      <tr>
        <th>Variavel</th>
        <th>Valor</th>
        <th>Ação</th>
        <th>Criação</th>
        <th>Remoção</th>
      </tr>

      <tr *ngFor="let v of v">
        <td>{{ v.name }}</td>
        <td>
          <ng-container *ngIf="v.type !== 'JSON'" ; jsonType>
            {{ v.value }}
          </ng-container>

          <ng-template #jsonType>
            <ngx-json-viewer
              [expanded]="false"
              [json]="v.value"
            ></ngx-json-viewer>
          </ng-template>
        </td>
        <td>{{ v.state }}</td>
        <td>{{ v.createTime | date : "M/d/yy, h:mm:ss" }}</td>
        <td>{{ v.removalTime | date : "M/d/yy, h:mm:ss" }}</td>
      </tr>
    </table>
  </div>
</div>

<ng-template #emptyVariable>Tarefa não contem variaveis.</ng-template>
